:root{
  --primary: #2c78bd;
  --map-z: 999;
  --toggle-width: 140px;
  --toggle-height: 35px;
  --toggle-knob-width: 70px;
  --map-top-left: 48%;
  --map-top-z: 999;
  --map-options-width: 14%;
  --map-options-panel-width: 15%;
  --map-button-left-mobile: 31%;
  --map-show-bottom: 3%;
  --map-hide-bottom: 62%;
}

/* Sidebar fixed for tablet+ */
@media only screen and (min-device-width: 768px) {
  #sidebar_route {
    position: fixed;
    overflow-x: hidden;
  }
}

/* Map containers */
#map_parent_div {
  position: relative;
  width: 100%;
  height: calc(100vh - 70px);
  transition: width .5s ease-in-out;
}

#map { width: 100%; height: 100%; }

#page_route { width: 100%; height: 100%; }

/* Content overlay (fixed under header) */
#content_route {
  position: fixed;
  top: 70px;
  left: 0;
  width: 100%;
  height: calc(100vh - 70px);
  transition: width .5s ease-in-out;
}

/* Datatable import panel (absolute bottom panel) */
#datatable_route_import_obs_clients_parent {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 60%;
  overflow: auto;
  z-index: var(--map-z);
}

/* show/hide controls */
#show_datatable_route_import_obs_clients_div { position: absolute; bottom: var(--map-show-bottom); left: 50%; z-index: var(--map-z); }
#hide_datatable_route_import_obs_clients_div { position: absolute; bottom: var(--map-hide-bottom); left: 50%; z-index: var(--map-z); }

/* Top-right map controls */
.map_top_buttons_parent_div {
  position: fixed;
  top: 75px;
  right: 1cqh; /* kept original unit (preserved) */
  z-index: var(--map-top-z);
  width: var(--map-options-width);
}

.map_top_infos_div { z-index: var(--map-top-z); }
.map_top_infos_div td, .map_top_infos_div th { font-size: 13px; color: #fff; }

/* Animated leaflet paths */
path.leaflet-interactive.animate {
  stroke-dasharray: 1920;
  stroke-dashoffset: 1920;
  animation: dash 20s linear 3s forwards;
}
@keyframes dash { to { stroke-dashoffset: 0; } }

/* Routing UI, top spacing */
.leaflet-routing-container { display: none; }
.leaflet-top { margin-top: 15px; }

/* Marker interactions */
.canvas-marker:hover { transform: scale(1.2); }

/* Marker clusters: combined custom sizes + base styling */
.marker-cluster-custom-small,
.marker-cluster-custom-medium,
.marker-cluster-custom-large,
.marker-cluster-custom-small div,
.marker-cluster-custom-medium div,
.marker-cluster-custom-large div {
  opacity: 0.9;
  background-color: none;
}

.marker-cluster div {
  width: 45px;
  height: 45px;
  padding: 15px;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 50%;
  font: 19px "Helvetica Neue", Arial, Helvetica, sans-serif;
}

/* Toggle / show-hide controls (grouped for #toggle_div & #show_hide_values_toggle_div) */
:is(#toggle_div, #show_hide_values_toggle_div) { position: relative; }
#map_top_middle_options_div { position: absolute; left: var(--map-top-left); z-index: var(--map-z); margin-top: 15px; }

/* button container / icons / labels */
:is(#toggle_div, #show_hide_values_toggle_div) div.btn-container {
  display: table-cell;
  vertical-align: middle;
  text-align: center;
}
:is(#toggle_div, #show_hide_values_toggle_div) div.btn-container i {
  display: inline-block;
  position: relative;
  top: -9px;
}
:is(#toggle_div, #show_hide_values_toggle_div) label {
  font-size: 13px;
  color: #424242;
  font-weight: 500;
}

/* switch base */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch {
  display: inline-block;
  margin: 0;
  position: relative;
}

/* inner switch (knob + track) */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch > label.btn-color-mode-switch-inner {
  margin: 0;
  width: var(--toggle-width);
  height: var(--toggle-height);
  background: #E0E0E0;
  border-radius: 26px;
  overflow: hidden;
  position: relative;
  transition: all .3s ease;
  display: block;
  cursor: pointer;
}

/* content tokens */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch > label.btn-color-mode-switch-inner:before {
  content: attr(data-on);
  position: absolute;
  font-size: 12px;
  font-weight: 500;
  top: 7px;
  right: 20px;
}
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch > label.btn-color-mode-switch-inner:after {
  content: attr(data-off);
  width: var(--toggle-knob-width);
  height: calc(var(--toggle-height) - 3px);
  background: #fff;
  border-radius: 26px;
  position: absolute;
  left: 2px;
  top: 2px;
  text-align: center;
  transition: all .3s ease;
  box-shadow: 0 0 6px -2px #111;
  padding: 5px 0;
}

/* hidden checkbox that drives the switch */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch input[type="checkbox"] {
  cursor: pointer;
  width: 50px;
  height: var(--toggle-height);
  opacity: 0;
  position: absolute;
  top: 0;
  z-index: 1;
  margin: 0;
}

/* checked states */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch input[type="checkbox"]:checked + label.btn-color-mode-switch-inner {
  background: var(--primary);
  color: #fff;
}
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch input[type="checkbox"]:checked + label.btn-color-mode-switch-inner:after {
  content: attr(data-on);
  left: 68px;
  background: #3c3c3c;
}
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch input[type="checkbox"]:checked + label.btn-color-mode-switch-inner:before {
  content: attr(data-off);
  right: auto;
  left: 20px;
}

/* alert element driven by checkbox (kept as original intent; show/hide may require JS) */
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch > .alert { display: none; background: #FF9800; border: none; color: #fff; }
:is(#toggle_div, #show_hide_values_toggle_div) .btn-color-mode-switch input[type="checkbox"]:checked ~ .alert { display: block; }

/* mode previews */
:is(#toggle_div, #show_hide_values_toggle_div) .dark-preview { background: var(--primary); }
:is(#toggle_div, #show_hide_values_toggle_div) .dark-preview div.btn-container i.fa-sun-o { color: #777; }
:is(#toggle_div, #show_hide_values_toggle_div) .dark-preview div.btn-container i.fa-moon-o { color: #fff; text-shadow: 0 0 11px #fff; }

:is(#toggle_div, #show_hide_values_toggle_div) .white-preview { background: #fff; }
:is(#toggle_div, #show_hide_values_toggle_div) .white-preview div.btn-container i.fa-sun-o { color: #ffa500; text-shadow: 0 0 16px #ffa500; }
:is(#toggle_div, #show_hide_values_toggle_div) .white-preview div.btn-container i.fa-moon-o { color: #777; }

/* link color handling in toggle areas */
:is(#toggle_div, #show_hide_values_toggle_div) p.by a { text-decoration: none; color: #000; }
:is(#toggle_div, #show_hide_values_toggle_div) .dark-preview p.by a { color: #777; }
:is(#toggle_div, #show_hide_values_toggle_div) .white-preview p.by a { color: #000; }

/* fixed position show-position btn */
#show_position_button { position: fixed; top: 75px; right: 7px; }

/* tweak when showing map: reduce top margin of leaflet UI */
#show_map .leaflet-top { margin-top: 5px !important; }

/* small screens: move position button & adjust top-middle options */
@media only screen and (max-device-width: 767px) {
  #show_position_button { top: 10px; right: 7px; }
  #map_top_middle_options_div { left: var(--map-button-left-mobile); margin-top: 15px; }
  .leaflet-top { margin-top: 5px; }
}

/* map icons */
.map_primary_icon { color: var(--primary); font-size: 55px; }
.map_primary_small_icon { color: var(--primary); font-size: 35px; }

/* show/hide map filters button container */
#show_hide_map_filters_button_div { position: absolute; right: 1cqh; z-index: var(--map-z); }

/* map shrink state (reduced width) */
.map_shrink { width: 85% !important; }

/* operations / filters panel */
#map_operations_filters_div {
  position: absolute;
  width: var(--map-options-panel-width) !important;
  transition: width .5s ease-in-out !important;
  overflow-y: auto;
  height: 100%;
}